<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>大场社区卫生服务中心 - 老年人免费体检预约系统</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: "Microsoft YaHei", sans-serif;
        }
        body {
            background-color: #f5f7fa;
            color: #333;
            line-height: 1.6;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        header {
            background: linear-gradient(135deg, #4a90e2, #63b3ed);
            color: white;
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 25px;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        .card {
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            padding: 25px;
            margin-bottom: 25px;
        }
        h1, h2, h3 {
            margin-bottom: 20px;
            color: #2c5282;
        }
        .form-group {
            margin-bottom: 20px;
        }
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
        }
        input, select {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 16px;
        }
        button {
            background: #4a90e2;
            color: white;
            border: none;
            padding: 14px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
        }
        .time-slots {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        .time-slot {
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
        }
        .time-slot.selected {
            background-color: #4a90e2;
            color: white;
        }
        .time-slot.full {
            background-color: #fed7d7;
            color: #742a2a;
            cursor: not-allowed;
        }
        .hidden {
            display: none;
        }
        .success {
            color: #22543d;
            background-color: #c6f6d5;
            padding: 12px;
            border-radius: 6px;
            margin-bottom: 15px;
        }
        .admin-stats {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }
        .stat-card {
            background: #4a90e2;
            color: white;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        th, td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #e2e8f0;
        }
        .tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 2px solid #e2e8f0;
        }
        .tab {
            padding: 12px 24px;
            cursor: pointer;
            font-weight: bold;
        }
        .tab.active {
            color: #4a90e2;
            border-bottom: 3px solid #4a90e2;
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
        .qrcode-container {
            text-align: center;
            margin: 20px 0;
            padding: 20px;
        }
        .deploy-guide {
            background-color: #e6fffa;
            border-left: 4px solid #38b2ac;
            padding: 20px;
            margin-bottom: 25px;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>大场社区卫生服务中心</h1>
            <p>老年人免费体检预约系统</p>
        </header>

        <div class="deploy-guide">
            <h3>部署成功指南</h3>
            <p>您的网站已部署到：<strong id="current-url">计算中...</strong></p>
            <p>分享此链接给用户，或让他们扫描右侧二维码</p>
        </div>

        <div class="tabs">
            <div class="tab active" data-tab="appointment">预约体检</div>
            <div class="tab" data-tab="qrcode">手机预约</div>
            <div class="tab" data-tab="admin">后台管理</div>
        </div>

        <!-- 预约体检标签页 -->
        <div class="tab-content active" id="appointment-tab">
            <div class="card">
                <h2>个人信息</h2>
                <form id="userForm">
                    <div class="form-group">
                        <label for="name">姓名</label>
                        <input type="text" id="name" required>
                    </div>
                    <div class="form-group">
                        <label for="idCard">身份证号</label>
                        <input type="text" id="idCard" required>
                    </div>
                    <div class="form-group">
                        <label for="phone">联系电话</label>
                        <input type="tel" id="phone" required>
                    </div>
                    <div class="form-group">
                        <label for="age">年龄</label>
                        <input type="number" id="age" required min="65">
                    </div>
                    <div class="form-group">
                        <label>预约项目</label>
                        <div>
                            <input type="checkbox" id="bUltrasound" value="B超">
                            <label for="bUltrasound">B超检查</label>
                        </div>
                        <div>
                            <input type="checkbox" id="ecg" value="心电图">
                            <label for="ecg">心电图检查</label>
                        </div>
                    </div>
                </form>
            </div>

            <div class="card">
                <h2>选择预约时间</h2>
                <div class="form-group">
                    <label for="appointmentDate">选择日期</label>
                    <input type="date" id="appointmentDate" required>
                </div>
                
                <div id="timeSlotsContainer" class="hidden">
                    <h3>可选时间段 (每半小时最多5人)</h3>
                    <div id="timeSlots" class="time-slots"></div>
                </div>
                
                <div id="appointmentDetails" class="hidden">
                    <div class="success">您已选择时间段: <span id="selectedTime"></span></div>
                    <button id="confirmAppointment">确认预约</button>
                </div>
            </div>

            <div id="appointmentResult" class="card hidden">
                <h2>预约成功</h2>
                <div id="appointmentInfo"></div>
                <button onclick="window.print()">打印预约凭证</button>
                <button id="newAppointment">新的预约</button>
            </div>
        </div>

        <!-- 手机预约标签页 -->
        <div class="tab-content" id="qrcode-tab">
            <div class="card">
                <h2>手机扫码预约</h2>
                <div class="qrcode-container">
                    <div id="qrcode">二维码将在这里显示</div>
                    <p>微信扫描二维码，快速预约体检</p>
                </div>
            </div>
        </div>

        <!-- 后台管理标签页 -->
        <div class="tab-content" id="admin-tab">
            <div class="card">
                <h2>预约统计</h2>
                <div class="admin-stats">
                    <div class="stat-card">
                        <div>今日预约</div>
                        <div id="todayCount">0</div>
                    </div>
                    <div class="stat-card">
                        <div>本周预约</div>
                        <div id="weekCount">0</div>
                    </div>
                    <div class="stat-card">
                        <div>总预约数</div>
                        <div id="totalCount">0</div>
                    </div>
                </div>
                
                <h3>所有预约记录</h3>
                <table id="appointmentsTable">
                    <thead>
                        <tr>
                            <th>姓名</th>
                            <th>身份证号</th>
                            <th>预约日期</th>
                            <th>时间段</th>
                            <th>检查项目</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        // 显示当前URL
        document.getElementById('current-url').textContent = window.location.href;
        
        // 标签页切换
        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', function() {
                document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                
                this.classList.add('active');
                const tabId = this.getAttribute('data-tab') + '-tab';
                document.getElementById(tabId).classList.add('active');
            });
        });

        // 模拟数据存储
        let appointments = JSON.parse(localStorage.getItem('appointments')) || {};
        
        // 初始化日期选择器
        const dateInput = document.getElementById('appointmentDate');
        const today = new Date();
        dateInput.min = today.toISOString().split('T')[0];
        
        // 监听日期变化
        dateInput.addEventListener('change', function() {
            generateTimeSlots(new Date(this.value));
            document.getElementById('timeSlotsContainer').classList.remove('hidden');
        });
        
        // 生成时间段
        function generateTimeSlots(date) {
            const timeSlotsContainer = document.getElementById('timeSlots');
            timeSlotsContainer.innerHTML = '';
            
            const dateStr = date.toISOString().split('T')[0];
            const timeSlots = ['13:30-14:00', '14:00-14:30', '14:30-15:00', '15:00-15:30', '15:30-16:00'];
            
            timeSlots.forEach(slot => {
                const slotElement = document.createElement('div');
                slotElement.className = 'time-slot';
                slotElement.innerHTML = `<div>${slot}</div><div>剩余: 5/5</div>`;
                
                slotElement.addEventListener('click', function() {
                    document.querySelectorAll('.time-slot').forEach(el => el.classList.remove('selected'));
                    this.classList.add('selected');
                    document.getElementById('selectedTime').textContent = `${dateStr} ${slot}`;
                    document.getElementById('appointmentDetails').classList.remove('hidden');
                });
                
                timeSlotsContainer.appendChild(slotElement);
            });
        }
        
        // 确认预约
        document.getElementById('confirmAppointment').addEventListener('click', function() {
            const name = document.getElementById('name').value;
            const idCard = document.getElementById('idCard').value;
            const selectedTime = document.getElementById('selectedTime').textContent;
            
            const appointment = {
                name, idCard,
                date: selectedTime.split(' ')[0],
                time: selectedTime.split(' ')[1],
                projects: ['B超', '心电图']
            };
            
            // 保存预约
            const key = selectedTime;
            if (!appointments[key]) appointments[key] = [];
            appointments[key].push(appointment);
            localStorage.setItem('appointments', JSON.stringify(appointments));
            
            // 显示结果
            document.getElementById('appointmentInfo').innerHTML = `
                <p><strong>预约编号:</strong> APT${Date.now()}</p>
                <p><strong>姓名:</strong> ${name}</p>
                <p><strong>身份证号:</strong> ${idCard}</p>
                <p><strong>预约时间:</strong> ${selectedTime}</p>
            `;
            document.getElementById('appointmentResult').classList.remove('hidden');
        });
        
        // 更新统计数据
        function updateAdminStats() {
            let todayCount = 0, weekCount = 0, totalCount = 0;
            
            Object.values(appointments).forEach(slotAppointments => {
                slotAppointments.forEach(appointment => {
                    totalCount++;
                    // 简单的统计逻辑
                    todayCount++;
                    weekCount++;
                });
            });
            
            document.getElementById('todayCount').textContent = todayCount;
            document.getElementById('weekCount').textContent = weekCount;
            document.getElementById('totalCount').textContent = totalCount;
            
            // 更新表格
            const tableBody = document.querySelector('#appointmentsTable tbody');
            tableBody.innerHTML = '';
            
            Object.values(appointments).forEach(slotAppointments => {
                slotAppointments.forEach(appointment => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${appointment.name}</td>
                        <td>${appointment.idCard}</td>
                        <td>${appointment.date}</td>
                        <td>${appointment.time}</td>
                        <td>${appointment.projects.join('、')}</td>
                    `;
                    tableBody.appendChild(row);
                });
            });
        }
        
        // 初始化
        updateAdminStats();
    </script>
</body>
</html>